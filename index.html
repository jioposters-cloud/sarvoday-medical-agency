<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Sarvoday Medical Agency Deesa</title><meta name="viewport" content="width=device-width,initial-scale=1"><style>:root{--primary:#0b8457;--primary-dark:#06623b;--bg:#f4f6f8}*{box-sizing:border-box;margin:0;padding:0}body{font-family:system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:var(--bg);color:#222;line-height:1.4}header{background:var(--primary);color:#fff;padding:12px 16px;display:flex;flex-wrap:wrap;align-items:center;gap:8px;justify-content:space-between}header h1{font-size:18px}header .sub{font-size:12px;opacity:.9}.top-right{display:flex;gap:8px;align-items:center}.pill-btn{border:none;padding:6px 10px;border-radius:16px;background:#fff;color:var(--primary-dark);font-size:12px;cursor:pointer;display:inline-flex;align-items:center;gap:4px}.pill-btn span.badge{background:var(--primary-dark);color:#fff;border-radius:999px;padding:2px 6px;font-size:11px}main{padding:10px;max-width:1100px;margin:0 auto}.panel{background:#fff;padding:10px;border-radius:8px;margin-bottom:10px;box-shadow:0 1px 3px rgba(0,0,0,.08)}.customer-form{display:grid;grid-template-columns:repeat(4,minmax(0,1fr));gap:8px}.customer-form label{font-size:11px;margin-bottom:2px;display:block}.customer-form input{width:100%;padding:6px 8px;border-radius:4px;border:1px solid #ccc;font-size:13px}.customer-form small{font-size:10px;color:#666;grid-column:1/-1}.toolbar{display:flex;flex-wrap:wrap;gap:8px;align-items:center;margin-bottom:8px}.toolbar input[type=search]{flex:1;min-width:160px;padding:6px 8px;border-radius:4px;border:1px solid #ccc;font-size:13px}.toolbar select{padding:6px 8px;border-radius:4px;border:1px solid #ccc;font-size:13px}.products{max-height:60vh;overflow:auto;border-radius:8px;border:1px solid #e0e0e0;background:#fff}table{border-collapse:collapse;width:100%;font-size:13px}th,td{padding:6px 8px;border-bottom:1px solid #eee;vertical-align:middle}th{position:sticky;top:0;z-index:1;background:#f7f9fb;font-size:12px}tr:nth-child(even){background:#fafafa}.qty-input{width:60px;padding:4px 6px;border:1px solid #ddd;border-radius:4px}.add-btn{background:var(--primary);color:#fff;border:none;padding:6px 12px;border-radius:4px;cursor:pointer;font-size:12px;font-weight:500}.add-btn:hover{background:var(--primary-dark)}.tab-btn{padding:8px 16px;border:1px solid #ddd;background:#fff;cursor:pointer;border-radius:4px;font-size:13px}.tab-btn.active{background:var(--primary);color:#fff;border-color:var(--primary)}.heart-btn{background:none;border:none;font-size:18px;cursor:pointer;color:#ccc;transition:color.2s}.heart-btn.active{color:#e63946}.cart-tick{color:#0b8457;font-weight:bold;font-size:14px;margin-right:4px}@media(max-width:768px){.customer-form{grid-template-columns:repeat(2,1fr)}.toolbar{flex-direction:column}.toolbar input[type=search]{width:100%}table{font-size:11px}th,td{padding:4px}.products{max-height:70vh}}</style></head><body><header><div><h1>Sarvoday Medical Agency, Deesa</h1><div class="sub">Pharma distributor product listing ‚Ä¢ Order via WhatsApp</div></div><div class="top-right"><button class="pill-btn" id="cartBtn"><span>üõí Cart</span><span class="badge" id="cartCount">0</span></button><button class="pill-btn" id="favBtn"><span>‚ù§ Favourites</span><span class="badge" id="favCount">0</span></button><button class="pill-btn" id="recentBtn"><span>‚è± Recent</span><span class="badge" id="recentCount">0</span></button></div></header><main><div class="panel"><div class="customer-form"><label>Party/Shop name</label><input type="text" id="partyName" placeholder=""><label>City</label><input type="text" id="city" placeholder=""><label>Mobile number</label><input type="text" id="mobile" placeholder=""><label>Optional GST/Code</label><input type="text" id="gst" placeholder=""><small>Details saved locally for faster repeat orders.</small></div></div><div class="panel"><div class="toolbar"><button class="tab-btn active" onclick="showTab('all')">All products</button><button class="tab-btn" onclick="showTab('cart')">Cart</button><button class="tab-btn" onclick="showTab('fav')">Favourites</button><button class="tab-btn" onclick="showTab('recent')">Recently ordered</button><input type="search" id="searchInput" placeholder="Search by name/company/salt/pack..."><select id="filterPack"><option value="">All packs</option></select><button onclick="clearSearch()">Clear</button></div><div id="mainList" class="products"><table><thead><tr><th>‚úì</th><th>Fav</th><th>Product</th><th>Qty</th><th>Add</th></tr></thead><tbody id="productsBody"></tbody></table></div></div></main><script>const SHEET_CSV_URL='https://docs.google.com/spreadsheets/d/1phazCTPu4dW2iHuKMIeMhZtz3kzQ3l3txEa5Fghz3xg/edit?usp=sharing&output=csv';let products=[];let cart=[];let favourites=[];let recentOrdered=[];function loadFromLocalStorage(){const saved=localStorage.getItem('medicalAgencyData');if(saved){const data=JSON.parse(saved);cart=data.cart||[];favourites=data.favourites||[];recentOrdered=data.recentOrdered||[];document.getElementById('partyName').value=data.partyName||'';document.getElementById('city').value=data.city||'';document.getElementById('mobile').value=data.mobile||'';document.getElementById('gst').value=data.gst||''}}function saveToLocalStorage(){const data={cart,favourites,recentOrdered,partyName:document.getElementById('partyName').value,city:document.getElementById('city').value,mobile:document.getElementById('mobile').value,gst:document.getElementById('gst').value};localStorage.setItem('medicalAgencyData',JSON.stringify(data))}function updateBadges(){document.getElementById('cartCount').textContent=cart.length;document.getElementById('favCount').textContent=favourites.length;document.getElementById('recentCount').textContent=recentOrdered.length}function isInCart(productId){return cart.some(item=>item.id===productId)}function renderProducts(){const query=document.getElementById('searchInput').value.toLowerCase();const packFilter=document.getElementById('filterPack').value;const tbody=document.getElementById('productsBody');tbody.innerHTML='';const filtered=products.filter(p=>{const text=(p.name||'')+(p.company||'')+(p.salt||'')+(p.pack||'');return text.toLowerCase().includes(query)&&(!packFilter||p.pack===packFilter)});filtered.forEach(p=>{const tr=document.createElement('tr');const tdCheck=document.createElement('td');const checkbox=document.createElement('input');checkbox.type='checkbox';checkbox.addEventListener('change',()=>{if(checkbox.checked){const qty=prompt('Enter quantity to add to cart:','1');if(!qty||isNaN(qty)||Number(qty)<=0){checkbox.checked=false;return}addToCart(p,Number(qty));checkbox.checked=false}});tdCheck.appendChild(checkbox);tr.appendChild(tdCheck);const tdFav=document.createElement('td');const heartBtn=document.createElement('button');heartBtn.type='button';heartBtn.className='heart-btn'+(favourites.includes(p.id)?' active':'');heartBtn.innerHTML='‚ù§';heartBtn.addEventListener('click',()=>toggleFavourite(p.id,heartBtn));tdFav.appendChild(heartBtn);tr.appendChild(tdFav);const tdName=document.createElement('td');const inCartTick=isInCart(p.id)?'<span class="cart-tick">‚úì</span>':'';tdName.innerHTML=inCartTick+'<strong>'+(p.name||'').toUpperCase()+'</strong>'+(p.salt?'<br><small>'+p.salt+'</small>':'');tr.appendChild(tdName);const tdQty=document.createElement('td');const qtyInput=document.createElement('input');qtyInput.type='number';qtyInput.min='1';qtyInput.value='1';qtyInput.className='qty-input';tdQty.appendChild(qtyInput);tr.appendChild(tdQty);const tdAdd=document.createElement('td');const addBtn=document.createElement('button');addBtn.className='add-btn';addBtn.textContent='Add';addBtn.addEventListener('click',()=>{const qty=Number(qtyInput.value);if(qty>0)addToCart(p,qty)});tdAdd.appendChild(addBtn);tr.appendChild(tdAdd);tbody.appendChild(tr)})}function addToCart(product,qty){const existingIndex=cart.findIndex(item=>item.id===product.id);if(existingIndex>=0){cart[existingIndex].qty+=qty}else{cart.push({id:product.id,name:product.name,qty})}recentOrdered.push({id:product.id,name:product.name});saveToLocalStorage();updateBadges();renderProducts()}function toggleFavourite(productId,btn){if(favourites.includes(productId)){favourites=favourites.filter(id=>id!==productId);btn.classList.remove('active')}else{favourites.push(productId);btn.classList.add('active')}saveToLocalStorage();updateBadges();renderProducts()}function showTab(tab){const tbody=document.getElementById('productsBody');tbody.innerHTML='';if(tab==='all'){renderProducts()}else if(tab==='cart'){cart.forEach(item=>{const tr=document.createElement('tr');const product=products.find(p=>p.id===item.id);tr.innerHTML=`<td>‚úì</td><td>‚ù§</td><td><strong>${product?.name||item.name}</strong></td><td><input type="number" class="qty-input" value="${item.qty}" onchange="updateCartQty('${item.id}',this.value)"></td><td><button class="add-btn" onclick="removeFromCart('${item.id}')">Remove</button></td>`;tbody.appendChild(tr)})}else if(tab==='fav'){const favProducts=products.filter(p=>favourites.includes(p.id));favProducts.forEach(p=>{const item=cart.find(c=>c.id===p.id);const tr=document.createElement('tr');tr.innerHTML=`<td></td><td>‚ù§</td><td><strong>${p.name}</strong></td><td><input type="number" class="qty-input" value="1"></td><td><button class="add-btn" onclick="addToCart({id:'${p.id}',name:'${p.name}'},1)">Add</button></td>`;tbody.appendChild(tr)})}else if(tab==='recent'){const uniqueRecent=[...new Map(recentOrdered.map(item=>[item.id,item])).values()];uniqueRecent.forEach(item=>{const product=products.find(p=>p.id===item.id);const tr=document.createElement('tr');tr.innerHTML=`<td></td><td></td><td><strong>${product?.name||item.name}</strong></td><td><input type="number" class="qty-input" value="1"></td><td><button class="add-btn" onclick="addToCart({id:'${item.id}',name:'${item.name}'},1)">Add</button></td>`;tbody.appendChild(tr)})}document.querySelectorAll('.tab-btn').forEach(btn=>btn.classList.remove('active'));event.target.classList.add('active')}function updateCartQty(productId,newQty){const item=cart.find(c=>c.id===productId);if(item)item.qty=Number(newQty);saveToLocalStorage();showTab('cart')}function removeFromCart(productId){cart=cart.filter(item=>item.id!==productId);saveToLocalStorage();updateBadges();showTab('cart')}function clearSearch(){document.getElementById('searchInput').value='';document.getElementById('filterPack').value='';renderProducts()}function renderPackFilter(){const packs=Array.from(new Set(products.map(p=>p.pack).filter(Boolean)));document.getElementById('filterPack').innerHTML='<option value="">All packs</option>'+packs.map(p=>`<option value="${p}">${p}</option>`).join('')}document.getElementById('searchInput').addEventListener('input',renderProducts);document.getElementById('filterPack').addEventListener('change',renderProducts);document.getElementById('cartBtn').addEventListener('click',()=>showTab('cart'));document.getElementById('favBtn').addEventListener('click',()=>showTab('fav'));document.getElementById('recentBtn').addEventListener('click',()=>showTab('recent'));async function loadProducts(){try{const response=await fetch(SHEET_CSV_URL);const csv=await response.text();const lines=csv.split('\n');products=lines.slice(1).map((line,idx)=>{const parts=line.split(',');return{id:idx,name:parts[1]?.trim()||'',company:parts[2]?.trim()||'',salt:parts[3]?.trim()||'',pack:parts[4]?.trim()||'',mrp:parts[5]?.trim()||''}}).filter(p=>p.name);renderPackFilter();renderProducts();updateBadges()}catch(e){console.error('Unable to load product list. Please check your internet connection.');document.getElementById('productsBody').innerHTML='<tr><td colspan="5">Unable to load product list. Please check your internet connection.</td></tr>'}}loadProducts()</script></body></html>
