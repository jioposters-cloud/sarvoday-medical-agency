<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"><title>Sarvoday Medical Agency Deesa</title><meta name="viewport" content="width=device-width,initial-scale=1"><style>:root{--primary:#0b8457;--primary-dark:#06623b;--bg:#f4f6f8}*{box-sizing:border-box;margin:0;padding:0}body{font-family:system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',sans-serif;background:var(--bg);color:#222;line-height:1.4}header{background:var(--primary);color:#fff;padding:12px 16px;display:flex;flex-wrap:wrap;align-items:center;gap:8px;justify-content:space-between}header h1{font-size:18px}header .sub{font-size:12px;opacity:.9}.top-right{display:flex;gap:8px;align-items:center}.pill-btn{border:none;padding:6px 10px;border-radius:16px;background:#fff;color:var(--primary-dark);font-size:12px;cursor:pointer;display:inline-flex;align-items:center;gap:4px}.pill-btn span.badge{background:var(--primary-dark);color:#fff;border-radius:999px;padding:2px 6px;font-size:11px}main{padding:10px;max-width:1100px;margin:0 auto}.panel{background:#fff;padding:10px;border-radius:8px;margin-bottom:10px;box-shadow:0 1px 3px rgba(0,0,0,.08)}.customer-form{display:grid;grid-template-columns:repeat(4,minmax(0,1fr));gap:8px}.customer-form label{font-size:11px;margin-bottom:2px;display:block}.customer-form input{width:100%;padding:6px 8px;border-radius:4px;border:1px solid #ccc;font-size:13px}.customer-form small{font-size:10px;color:#666;grid-column:1/-1}.toolbar{display:flex;flex-wrap:wrap;gap:8px;align-items:center;margin-bottom:8px}.toolbar input[type=search]{flex:1;min-width:160px;padding:6px 8px;border-radius:4px;border:1px solid #ccc;font-size:13px}.toolbar select{padding:6px 8px;border-radius:4px;border:1px solid #ccc;font-size:13px}.products{max-height:60vh;overflow:auto;border-radius:8px;border:1px solid #e0e0e0;background:#fff}table{border-collapse:collapse;width:100%;font-size:13px}th,td{padding:6px 8px;border-bottom:1px solid #eee;vertical-align:middle}th{position:sticky;top:0;z-index:1;background:#f7f9fb;font-size:12px}tr:nth-child(even){background:#fafafa}.qty-input{width:60px;padding:4px 6px;border-radius:4px;border:1px solid #ccc;font-size:12px}.btn-small{padding:4px 8px;border-radius:4px;font-size:12px;border:none;cursor:pointer;background:var(--primary);color:#fff;white-space:nowrap}.btn-small.secondary{background:#e0e0e0;color:#333}.heart-btn{border:none;background:none;cursor:pointer;font-size:16px;color:#bbb}.heart-btn.active{color:#e63946}.checkbox-center{text-align:center}.cart-summary{display:flex;flex-wrap:wrap;gap:8px;align-items:center;justify-content:space-between;font-size:13px}.cart-summary-left{display:flex;flex-wrap:wrap;gap:8px;align-items:center}.cart-summary button{display:inline-flex;align-items:center;gap:4px}.tab-buttons{display:flex;gap:8px;margin-bottom:8px;flex-wrap:wrap}.tab-buttons button{border-radius:20px;border:1px solid var(--primary);background:#fff;color:var(--primary-dark);padding:6px 12px;font-size:12px;cursor:pointer}.tab-buttons button.active{background:var(--primary);color:#fff}.list-empty{font-size:13px;color:#666;padding:6px 0}@media(max-width:768px){header{flex-direction:column;align-items:flex-start}.customer-form{grid-template-columns:repeat(2,minmax(0,1fr))}.cart-summary{flex-direction:column;align-items:flex-start}.heart-btn{color:#e63946}table th:nth-child(n+4),table td:nth-child(n+4){display:none}}@media(max-width:480px){.customer-form{grid-template-columns:1fr}th,td{font-size:11px}.btn-small{font-size:11px;padding:4px 6px}.heart-btn{color:#e63946}table th:nth-child(n+4),table td:nth-child(n+4){display:none}}</style></head><body><header><div><h1>Sarvoday Medical Agency, Deesa</h1><div class="sub">Pharma distributor product listing ‚Ä¢ Order via WhatsApp</div></div><div class="top-right"><button class="pill-btn" id="btnCartTab">üõí Cart <span class="badge" id="cartCountBadge">0</span></button><button class="pill-btn" id="btnFavTab">‚ù§ Favourites <span class="badge" id="favCountBadge">0</span></button><button class="pill-btn" id="btnRecentTab">‚è± Recent <span class="badge" id="recentCountBadge">0</span></button></div></header><main><section class="panel"><form class="customer-form" id="customerForm"><div><label for="partyName">Party/Shop name</label><input id="partyName" type="text" placeholder="IMAX Dental Clinic"></div><div><label for="city">City</label><input id="city" type="text" placeholder="Deesa"></div><div><label for="mobile">Mobile number</label><input id="mobile" type="tel" placeholder="10-digit number"></div><div><label for="gst">Optional GST/Code</label><input id="gst" type="text" placeholder="Code/GST"></div><small>Details saved locally for faster repeat orders.</small></form></section><section class="panel"><div class="tab-buttons"><button class="active" data-tab="products">All products</button><button data-tab="cart">Cart</button><button data-tab="favourites">Favourites</button><button data-tab="recent">Recently ordered</button></div><div id="tab-products"><div class="toolbar"><input type="search" id="searchInput" placeholder="Search by name/company/salt/pack..."><select id="filterPack"><option>All packs</option></select><button class="btn-small secondary" id="btnClearFilters">Clear</button></div><div class="products"><table id="productsTable"><thead><tr><th class="checkbox-center">‚úì</th><th>Fav</th><th>Product</th><th style="display:none">Company</th><th style="display:none">Pack</th><th style="display:none">MRP</th><th>Qty</th><th>Add</th></tr></thead><tbody id="productsBody"></tbody></table></div></div><div id="tab-cart" style="display:none"><div id="cartList"></div><div class="cart-summary"><div class="cart-summary-left"><span><strong>Cart:</strong><span id="cartItemCount">0</span> items</span><button class="btn-small secondary" id="btnClearCart">Clear cart</button></div><button class="btn-small" id="btnCheckout">üì≤ Place order on WhatsApp</button></div></div><div id="tab-favourites" style="display:none"><div id="favList"></div></div><div id="tab-recent" style="display:none"><div id="recentList"></div></div></section></main><script>const SHEET_CSV_URL='https://docs.google.com/spreadsheets/d/2PACX-1vQS1dqKIfUgHngRrRzNp-fY6CvkO9c15fOBp0DaU9u8KXcvfAARTAbZOqwxj5Bu2hDE0JWA_EfDtf/export?format=csv',WHATSAPP_NUMBER='919016284250';let products=[],cart=JSON.parse(localStorage.getItem('sarvoday_cart')||'[]'),favourites=JSON.parse(localStorage.getItem('sarvoday_fav')||'[]'),recentOrders=JSON.parse(localStorage.getItem('sarvoday_recent')||'[]'),customerDetails=JSON.parse(localStorage.getItem('sarvoday_customer')||JSON.stringify({partyName:'',city:'',mobile:'',gst:''}));const productsBody=document.getElementById('productsBody'),filterPack=document.getElementById('filterPack'),searchInput=document.getElementById('searchInput'),cartList=document.getElementById('cartList'),favList=document.getElementById('favList'),recentList=document.getElementById('recentList'),tabButtons=document.querySelectorAll('.tab-buttons button'),tabs={products:document.getElementById('tab-products'),cart:document.getElementById('tab-cart'),favourites:document.getElementById('tab-favourites'),recent:document.getElementById('tab-recent')},partyNameInput=document.getElementById('partyName'),cityInput=document.getElementById('city'),mobileInput=document.getElementById('mobile'),gstInput=document.getElementById('gst'),cartCountBadge=document.getElementById('cartCountBadge'),favCountBadge=document.getElementById('favCountBadge'),recentCountBadge=document.getElementById('recentCountBadge'),cartItemCount=document.getElementById('cartItemCount');partyNameInput.value=customerDetails.partyName||'';cityInput.value=customerDetails.city||'';mobileInput.value=customerDetails.mobile||'';gstInput.value=customerDetails.gst||'';function saveCustomerDetails(){const obj={partyName:partyNameInput.value.trim(),city:cityInput.value.trim(),mobile:mobileInput.value.trim(),gst:gstInput.value.trim()};localStorage.setItem('sarvoday_customer',JSON.stringify(obj));}['input','change'].forEach(ev=>{partyNameInput.addEventListener(ev,saveCustomerDetails);cityInput.addEventListener(ev,saveCustomerDetails);mobileInput.addEventListener(ev,saveCustomerDetails);gstInput.addEventListener(ev,saveCustomerDetails);});function saveCart(){localStorage.setItem('sarvoday_cart',JSON.stringify(cart));updateBadges();}function saveFav(){localStorage.setItem('sarvoday_fav',JSON.stringify(favourites));updateBadges();}function saveRecent(){localStorage.setItem('sarvoday_recent',JSON.stringify(recentOrders));updateBadges();}function updateBadges(){cartCountBadge.textContent=cart.length;favCountBadge.textContent=favourites.length;recentCountBadge.textContent=recentOrders.length;cartItemCount.textContent=cart.length;}function parseCSV(text){const rows=text.trim().split(/\n/).map(r=>r.split(','));const header=rows[0].map(h=>h.trim());return rows.slice(1).map(row=>{const obj={};header.forEach((h,i)=>{obj[h]=(row[i]||'').trim();});return obj;});}function normalizeProduct(raw,index){return{id:raw.ID||raw.Id||String(index),name:raw.Product||raw.Name||raw['Product Name']||'',company:raw.Company||raw.Mfg||'',salt:raw.Salt||raw.Content||'',pack:raw.Pack||raw.Packing||'',mrp:raw.MRP||raw.Rate||''};}
function renderPackFilter(){const packs=Array.from(new Set(products.map(p=>p.pack).filter(Boolean)));filterPack.innerHTML='<option value="">All packs</option>'+packs.map(p=>`<option value="${p}">${p}</option>`).join('');}function renderProducts(){const q=searchInput.value.toLowerCase(),packFilter=filterPack.value,favIds=new Set(favourites);productsBody.innerHTML='';products.filter(p=>{const text=(p.name||'')+' '+(p.company||'')+' '+(p.salt||'')+' '+(p.pack||'');return text.toLowerCase().includes(q)&&(!packFilter||p.pack===packFilter);}).forEach(p=>{const tr=document.createElement('tr'),tdCheck=document.createElement('td');tdCheck.className='checkbox-center';const checkbox=document.createElement('input');checkbox.type='checkbox';checkbox.addEventListener('change',()=>{if(checkbox.checked){const qty=prompt('Enter quantity to add to cart:','1');if(!qty||isNaN(qty)||Number(qty)<=0){checkbox.checked=false;return;}addToCart(p,Number(qty));checkbox.checked=false;}});tdCheck.appendChild(checkbox);tr.appendChild(tdCheck);const tdFav=document.createElement('td'),heartBtn=document.createElement('button');heartBtn.type='button';heartBtn.className='heart-btn'+(favIds.has(p.id)?'active':'');heartBtn.innerHTML='‚ù§';heartBtn.addEventListener('click',()=>toggleFavourite(p.id,heartBtn));tdFav.appendChild(heartBtn);tr.appendChild(tdFav);const tdName=document.createElement('td');tdName.innerHTML='<strong>'+(p.name||'').toUpperCase()+'</strong>'+(p.salt?'<br><small>'+p.salt+'</small>':'');tr.appendChild(tdName);const tdCompany=document.createElement('td');tdCompany.textContent=p.company||'';tdCompany.style.display='none';tr.appendChild(tdCompany);const tdPack=document.createElement('td');tdPack.textContent=p.pack||'';tdPack.style.display='none';tr.appendChild(tdPack);const tdMrp=document.createElement('td');tdMrp.textContent=p.mrp||'';tdMrp.style.display='none';tr.appendChild(tdMrp);const tdQty=document.createElement('td'),qtyInput=document.createElement('input');qtyInput.type='number';qtyInput.min='1';qtyInput.value='1';qtyInput.className='qty-input';tdQty.appendChild(qtyInput);tr.appendChild(tdQty);const tdAdd=document.createElement('td'),addBtn=document.createElement('button');addBtn.type='button';addBtn.className='btn-small';addBtn.textContent='Add';addBtn.addEventListener('click',()=>{const qty=Number(qtyInput.value||'0');if(!qty||qty<=0){alert('Enter valid quantity.');return;}addToCart(p,qty);});tdAdd.appendChild(addBtn);tr.appendChild(tdAdd);productsBody.appendChild(tr);});if(!productsBody.children.length){const tr=document.createElement('tr'),td=document.createElement('td');td.colSpan=8;td.textContent='No products found with current filters.';tr.appendChild(td);productsBody.appendChild(tr);}}function addToCart(p,qty){const idx=cart.findIndex(i=>i.id===p.id);if(idx>-1){cart[idx].qty+=qty;}else{cart.push({id:p.id,name:p.name,company:p.company,pack:p.pack,mrp:p.mrp,qty});}saveCart();renderCart();}function toggleFavourite(id,heartBtn){const i=favourites.indexOf(id);if(i>-1){favourites.splice(i,1);heartBtn.classList.remove('active');}else{favourites.push(id);heartBtn.classList.add('active');}saveFav();renderFavourites();}function renderCart(){cartList.innerHTML='';if(!cart.length){cartList.innerHTML='<div class="list-empty">Cart is empty.</div>';return;}cart.forEach((item,idx)=>{const row=document.createElement('div');row.style.display='flex';row.style.alignItems='center';row.style.justifyContent='space-between';row.style.gap='8px';row.style.padding='4px 0';row.style.borderBottom='1px solid #eee';const left=document.createElement('div');left.style.flex='1';left.innerHTML='<strong>'+item.name.toUpperCase()+'</strong>'+(item.pack?' ‚Ä¢ '+item.pack:'')+(item.company?'<br><small>'+item.company+'</small>':'');row.appendChild(left);const right=document.createElement('div');right.style.display='flex';right.style.alignItems='center';right.style.gap='6px';const qtyInput=document.createElement('input');qtyInput.type='number';qtyInput.min='1';qtyInput.value=item.qty;qtyInput.className='qty-input';qtyInput.addEventListener('change',()=>{const v=Number(qtyInput.value||'0');if(!v||v<=0){if(confirm('Remove this item from cart?')){cart.splice(idx,1);}else{qtyInput.value=item.qty;return;}}else{item.qty=v;}saveCart();renderCart();});right.appendChild(qtyInput);const removeBtn=document.createElement('button');removeBtn.type='button';removeBtn.className='btn-small secondary';removeBtn.textContent='Remove';removeBtn.addEventListener('click',()=>{cart.splice(idx,1);saveCart();renderCart();});right.appendChild(removeBtn);row.appendChild(right);cartList.appendChild(row);});}function renderFavourites(){favList.innerHTML='';if(!favourites.length){favList.innerHTML='<div class="list-empty">No favourites yet. Use ‚ù§ on product list.</div>';return;}favourites.forEach(id=>{const p=products.find(x=>x.id===id);if(!p)return;const row=document.createElement('div');row.style.display='flex';row.style.alignItems='center';row.style.justifyContent='space-between';row.style.gap='8px';row.style.padding='4px 0';row.style.borderBottom='1px solid #eee';const left=document.createElement('div');left.style.flex='1';left.innerHTML='<strong>'+p.name.toUpperCase()+'</strong>'+(p.pack?' ‚Ä¢ '+p.pack:'')+(p.company?'<br><small>'+p.company+'</small>':'');row.appendChild(left);const right=document.createElement('div');right.style.display='flex';right.style.alignItems='center';right.style.gap='6px';const qtyInput=document.createElement('input');qtyInput.type='number';qtyInput.min='1';qtyInput.value='1';qtyInput.className='qty-input';right.appendChild(qtyInput);const addBtn=document.createElement('button');addBtn.type='button';addBtn.className='btn-small';addBtn.textContent='Add to cart';addBtn.addEventListener('click',()=>{const qty=Number(qtyInput.value||'0');if(!qty||qty<=0){alert('Enter valid quantity.');return;}addToCart(p,qty);});right.appendChild(addBtn);const favBtn=document.createElement('button');favBtn.type='button';favBtn.className='btn-small secondary';favBtn.textContent='Remove fav';favBtn.addEventListener('click',()=>{favourites=favourites.filter(x=>x!==id);saveFav();renderFavourites();renderProducts();});right.appendChild(favBtn);row.appendChild(right);favList.appendChild(row);});}function renderRecent(){recentList.innerHTML='';if(!recentOrders.length){recentList.innerHTML='<div class="list-empty">No recent orders yet. After WhatsApp checkout, list will be saved here.</div>';return;}recentOrders.forEach((order,index)=>{const container=document.createElement('div');container.style.borderBottom='1px solid #eee';container.style.padding='6px 0';const header=document.createElement('div');header.style.display='flex';header.style.justifyContent='space-between';header.style.alignItems='center';header.innerHTML='<strong>Order '+(recentOrders.length-index)+'</strong>'+(order.date?' <small style="color:#666;">'+order.date+'</small>':'');container.appendChild(header);const itemsBox=document.createElement('div');order.items.forEach(item=>{const row=document.createElement('div');row.style.display='flex';row.style.alignItems='center';row.style.justifyContent='space-between';row.style.gap='8px';row.style.marginTop='3px';const left=document.createElement('div');left.style.flex='1';left.innerHTML=item.qty+' √ó <strong>'+item.name.toUpperCase()+'</strong>'+(item.pack?' ‚Ä¢ '+item.pack:'');row.appendChild(left);const right=document.createElement('div');right.style.display='flex';right.style.alignItems='center';right.style.gap='6px';const qtyInput=document.createElement('input');qtyInput.type='number';qtyInput.min='1';qtyInput.value=item.qty;qtyInput.className='qty-input';right.appendChild(qtyInput);const addBtn=document.createElement('button');addBtn.type='button';addBtn.className='btn-small';addBtn.textContent='Add to cart';addBtn.addEventListener('click',()=>{const qty=Number(qtyInput.value||'0');if(!qty||qty<=0){alert('Enter valid quantity.');return;}const p=products.find(x=>x.id===item.id)||item;addToCart(p,qty);});right.appendChild(addBtn);row.appendChild(right);itemsBox.appendChild(row);});container.appendChild(itemsBox);recentList.appendChild(container);});}tabButtons.forEach(btn=>{btn.addEventListener('click',()=>{const tab=btn.dataset.tab;tabButtons.forEach(b=>b.classList.remove('active'));btn.classList.add('active');Object.entries(tabs).forEach(([key,el])=>{el.style.display=key===tab?'block':'none';});if(tab==='cart')renderCart();if(tab==='favourites')renderFavourites();if(tab==='recent')renderRecent();});});document.getElementById('btnCartTab').onclick=()=>{document.querySelector('.tab-buttons button[data-tab="cart"]').click();};document.getElementById('btnFavTab').onclick=()=>{document.querySelector('.tab-buttons button[data-tab="favourites"]').click();};document.getElementById('btnRecentTab').onclick=()=>{document.querySelector('.tab-buttons button[data-tab="recent"]').click();};searchInput.addEventListener('input',renderProducts);filterPack.addEventListener('change',renderProducts);document.getElementById('btnClearFilters').addEventListener('click',()=>{searchInput.value='';filterPack.value='';renderProducts();});document.getElementById('btnClearCart').addEventListener('click',()=>{if(!cart.length)return;if(confirm('Clear entire cart?')){cart=[];saveCart();renderCart();}});function formatWhatsAppMessage(){if(!cart.length){alert('Cart is empty.');return null;}const customer=JSON.parse(localStorage.getItem('sarvoday_customer')||JSON.stringify({partyName:'',city:'',mobile:'',gst:''}));let msg='Sarvoday Medical Agency Deesa - Order Request%0A%0A';if(customer.partyName)msg+='Party: '+encodeURIComponent(customer.partyName)+'%0A';if(customer.city)msg+='City: '+encodeURIComponent(customer.city)+'%0A';if(customer.mobile)msg+='Mobile: '+encodeURIComponent(customer.mobile)+'%0A';if(customer.gst)msg+='Code/GST: '+encodeURIComponent(customer.gst)+'%0A';msg+='%0AItems:%0A';cart.forEach((item,idx)=>{const line=(idx+1)+'. '+item.name+(item.pack?' ('+item.pack+')':'')+' - Qty: '+item.qty;msg+=encodeURIComponent(line)+'%0A';});return msg;}document.getElementById('btnCheckout').addEventListener('click',()=>{const msg=formatWhatsAppMessage();if(!msg)return;const orderSnapshot={date:new Date().toLocaleString(),items:cart.map(i=>({...i}))};recentOrders.unshift(orderSnapshot);if(recentOrders.length>20)recentOrders.pop();saveRecent();const url='https://wa.me/'+WHATSAPP_NUMBER+'?text='+msg;window.open(url,'_blank');});async function init(){updateBadges();try{const res=await fetch(SHEET_CSV_URL);const text=await res.text();const raw=parseCSV(text);products=raw.map(normalizeProduct);renderPackFilter();renderProducts();renderCart();renderFavourites();}catch(e){alert('Unable to load product list. Please check your internet connection.');}}init();</script></body></html>
